function Html2Gif(e,t){if(!(this instanceof arguments.callee))throw Error("Constructor called as a function. Useage: new Html2Gif(element, options)");var n=this,o=new Blob([workerSrc]),a=window.URL.createObjectURL(o);n.worker=new Worker(a),t=t||{},t.width=t.width||320,t.height=t.height||240,t.gifDelay=t.gifDelay||200,t.quality=t.quality||10,n.options=t,n.worker.postMessage({cmd:"init",width:t.width,height:t.height,delay:t.gifDelay,quality:t.quality}),n.worker.addEventListener("message",function(e){var t=btoa(e.data),o="data:image/gif;base64,"+t;"function"==typeof n.oncomplete&&n.oncomplete(o)},!1)}var workerSrc='module={set exports(e){module[e.name]=e}},require=function(e){return e=e.replace(/Typed/,""),e=e.match(/\\/(.*)\\./)[1],module[e]};var encoder,cmd={init:function(e){encoder=new GIFEncoder(e.width,e.height),encoder.setQuality(e.quality||30),encoder.setDelay(e.delay||0),encoder.setRepeat(e.repeat||0),encoder.writeHeader(),encoder.firstFrame=!0},addFrame:function(e){encoder.addFrame(e),encoder.firstFrame=!1},end:function(){self.postMessage(encoder.out.getData())}};self.addEventListener("message",function(e){var d=e.data,t=cmd[e.data.cmd];t||(t=cmd.addFrame),t(d)},!1);';Html2Gif.prototype.start=function(e,t){var n=this;e>0&&t>0&&(n.timer=setInterval(function(){n.snap(),t--,0===t&&n.end()},e))},Html2Gif.prototype.snap=function(){var e=this;html2canvas(document.body,{onrendered:function(t){var n=t.getContext("2d");e.worker.postMessage(n.getImageData(0,0,e.options.width,e.options.height).data)},width:e.options.width,height:e.options.height})},Html2Gif.prototype.end=function(){clearInterval(this.timer),this.worker.postMessage({cmd:"end"})};